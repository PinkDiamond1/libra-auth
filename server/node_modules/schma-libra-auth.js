/*
mkdir -p /db/mongodb/libra-auth-addr
mkdir -p /db/log/libra-auth-addr/
$ mongod --journal --smallfiles --port 27020 --dbpath /db/mongodb/libra-auth-addr --fork --logpath /db/log/libra-auth-addr/mongodb.log --logappend

npm install mongoose

crontab -e 
@reboot mongod --journal --smallfiles --port 27020 --dbpath /db/mongodb/libra-auth-addr --fork --logpath /db/log/libra-auth-addr/mongodb.log --logappend

// これ必要かな MongoDB3.4をインストール後のウォーニングを消す
https://code-macchiato.com/tips/ubuntu-remove-mongodb-warning
*/
const mongoose = require('mongoose');
const tanshindb = mongoose.createConnection('mongodb://localhost:27020/libra-auth', { 
    useNewUrlParser: true
});
mongoose.set('useFindAndModify', false);
mongoose.set('useCreateIndex', true);


//---------------------------------------------------------
// libra-auth
// 
let libraauthSchema = {
   utime: {type: Number, required: true}
  ,addr : {type: String, required: true}
  //,pubkey:{type: String, required: true} //Add later
  ,sigB : {type: String, required: true}
}
// スキーマ定義
let schemaLibraauth = new mongoose.Schema(libraauthSchema);
// モデル定義
let modelLibraAuth = tanshindb.model('libra-auth', schemaLibraauth);


//---------------------------------------------------------
// 操作用オブジェクト
let schema = new function() {
    this.modelLibraAuth = modelLibraAuth;
};

// モジュール化
module.exports = schema;